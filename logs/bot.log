2025-07-20 15:24:55 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:25:39 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:27:06 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:27:37 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:29:47 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:30:12 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:31:00 | DEBUG | Using proactor: IocpProactor
2025-07-20 15:31:01 | INFO | Starting bot...
2025-07-20 15:31:01 | INFO | Start polling
2025-07-20 15:31:04 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-20 15:31:17 | INFO | Update id=259321293 is not handled. Duration 4046 ms by bot id=7986781338
2025-07-20 15:31:17 | ERROR | Cause exception while process update id=259321293 by bot id=7986781338
ConnectionError: Error 22 connecting to localhost:6379. Удаленный компьютер отклонил это сетевое подключение.
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
          │    │     └ <function Retry.call_with_retry at 0x0000025167AE99E0>
          │    └ <redis.asyncio.retry.Retry object at 0x00000251686E32C0>
          └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
                 └ <function AbstractConnection.connect_check_health.<locals>.<lambda> at 0x0000025169BCA700>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                           │       └ <function open_connection at 0x0000025162672FC0>
                           └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x00000251626714E0>
                         └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1127, in create_connection
    raise exceptions[0]
          └ None
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x0000025162671440>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 6379, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=23, type=1, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x00000251626B7920>
          └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 6379, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=23, type=1, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x0000025162706200>
                 │    └ <IocpProactor overlapped#=2 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 803, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x0000025169B7D530>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x0000025169BCA520>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x0000025169B7D530>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 74, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000251687719E0>
    │       └ <function run at 0x000002516264F560>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000025168B4DAD0>
           │      └ <function Runner.run at 0x0000025162672A20>
           └ <asyncio.runners.Runner object at 0x0000025169B86FF0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:62> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000251626705E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000025169B86FF0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000025162705580>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000025162672340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000251625F62A0>
    └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x25169ba8c80'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000251672DE360>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321293, message=Message(message_id=8, date=datetime.datetime(2025, 7, 20, 12, 31, 12, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000251672DE360>
                     │    └ <function Dispatcher.feed_update at 0x0000025167A439C0>
                     └ <Dispatcher '0x25169ba8c80'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025167A423E0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025169BA9EE0>
                     └ <Dispatcher '0x25169ba8c80'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x25169ba8c80'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000251672DE360>,), 'skip_updates'...
                 │       └ Update(update_id=259321293, message=Message(message_id=8, date=datetime.datetime(2025, 7, 20, 12, 31, 12, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000025169BAA000>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x25169ba8c80'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000251672DE360>,), 'skip_updates'...
                 │       └ Update(update_id=259321293, message=Message(message_id=8, date=datetime.datetime(2025, 7, 20, 12, 31, 12, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000025169BAA060>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    data.update({"state": context, "raw_state": await context.get_state()})
    │    │                │                           │       └ <function FSMContext.get_state at 0x00000251679F8EA0>
    │    │                │                           └ <aiogram.fsm.context.FSMContext object at 0x0000025169BF8140>
    │    │                └ <aiogram.fsm.context.FSMContext object at 0x0000025169BF8140>
    │    └ <method 'update' of 'dict' objects>
    └ {'dispatcher': <Dispatcher '0x25169ba8c80'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000251672DE360>,), 'skip_updates'...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\context.py", line 15, in get_state
    return await self.storage.get_state(key=self.key)
                 │    │       │             │    └ StorageKey(bot_id=7986781338, chat_id=6826384730, user_id=6826384730, thread_id=None, business_connection_id=None, destiny='d...
                 │    │       │             └ <aiogram.fsm.context.FSMContext object at 0x0000025169BF8140>
                 │    │       └ <function RedisStorage.get_state at 0x0000025167C91C60>
                 │    └ <aiogram.fsm.storage.redis.RedisStorage object at 0x0000025169BA8C20>
                 └ <aiogram.fsm.context.FSMContext object at 0x0000025169BF8140>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 99, in get_state
    value = await self.redis.get(redis_key)
                  │    │     │   └ 'fsm:6826384730:6826384730:state'
                  │    │     └ <function BasicKeyCommands.get at 0x0000025167BDB4C0>
                  │    └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port...
                  └ <aiogram.fsm.storage.redis.RedisStorage object at 0x0000025169BA8C20>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
           │    │                   │    └ <function ConnectionPool.get_connection at 0x0000025167B36A20>
           │    │                   └ <redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>)>
           │    └ None
           └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
          │    │                 └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
          │    └ <function ConnectionPool.ensure_connection at 0x0000025167B36C00>
          └ <redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
          │          └ <function AbstractConnection.connect at 0x0000025167B349A0>
          └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
          │    └ <function AbstractConnection.connect_check_health at 0x0000025167B34A40>
          └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
          │               │    └ <function AbstractConnection._error_message at 0x0000025167B34C20>
          │               └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
          └ <class 'redis.exceptions.ConnectionError'>

redis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. Удаленный компьютер отклонил это сетевое подключение.
2025-07-20 15:32:13 | INFO | Polling stopped
2025-07-20 15:32:13 | ERROR | Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-07-20 15:32:13 | WARNING | Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7986781338)
2025-07-20 15:32:14 | INFO | Bot stopped
2025-07-20 15:32:14 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-20 23:28:46 | DEBUG | Using proactor: IocpProactor
2025-07-20 23:28:47 | INFO | Starting bot...
2025-07-20 23:28:47 | INFO | Start polling
2025-07-20 23:28:48 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-20 23:30:35 | INFO | Update id=259321294 is not handled. Duration 4265 ms by bot id=7986781338
2025-07-20 23:30:35 | ERROR | Cause exception while process update id=259321294 by bot id=7986781338
ConnectionError: Error 22 connecting to localhost:6379. Удаленный компьютер отклонил это сетевое подключение.
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 302, in connect_check_health
    await self.retry.call_with_retry(
          │    │     └ <function Retry.call_with_retry at 0x00000218F3CD99E0>
          │    └ <redis.asyncio.retry.Retry object at 0x00000218F5DE69C0>
          └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\retry.py", line 71, in call_with_retry
    return await do()
                 └ <function AbstractConnection.connect_check_health.<locals>.<lambda> at 0x00000218F5DBBB00>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 755, in _connect
    reader, writer = await asyncio.open_connection(
                           │       └ <function open_connection at 0x00000218EE862FC0>
                           └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                         │    └ <function BaseEventLoop.create_connection at 0x00000218EE8614E0>
                         └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1127, in create_connection
    raise exceptions[0]
          └ None
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
                 │    └ <function BaseEventLoop._connect_sock at 0x00000218EE861440>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
          │    │            │     └ ('::1', 6379, 0, 0)
          │    │            └ <socket.socket [closed] fd=-1, family=23, type=1, proto=0>
          │    └ <function BaseProactorEventLoop.sock_connect at 0x00000218EE8A7920>
          └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
                 │    │         │       │     └ ('::1', 6379, 0, 0)
                 │    │         │       └ <socket.socket [closed] fd=-1, family=23, type=1, proto=0>
                 │    │         └ <function IocpProactor.connect at 0x00000218EE8F6200>
                 │    └ <IocpProactor overlapped#=2 result#=0>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 803, in _poll
    value = callback(transferred, key, ov)
            │        │            │    └ <_overlapped.Overlapped object at 0x00000218F5D6D2F0>
            │        │            └ 0
            │        └ 0
            └ <function IocpProactor.connect.<locals>.finish_connect at 0x00000218F5DB94E0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 599, in finish_connect
    ov.getresult()
    │  └ <method 'getresult' of '_overlapped.Overlapped' objects>
    └ <_overlapped.Overlapped object at 0x00000218F5D6D2F0>

ConnectionRefusedError: [WinError 1225] Удаленный компьютер отклонил это сетевое подключение


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 74, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000218F49619E0>
    │       └ <function run at 0x00000218EE83F560>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000218F5D0DAD0>
           │      └ <function Runner.run at 0x00000218EE862A20>
           └ <asyncio.runners.Runner object at 0x00000218F5D744D0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:62> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000218EE8605E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000218F5D744D0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000218EE8F5580>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000218EE862340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000218EE7E62A0>
    └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<_OverlappedF..., 1225, None)>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x218f492c860'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000218F49BDD90>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321294, message=Message(message_id=9, date=datetime.datetime(2025, 7, 20, 20, 30, 31, tzinfo=TzInfo(UTC))...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000218F49BDD90>
                     │    └ <function Dispatcher.feed_update at 0x00000218F3C339C0>
                     └ <Dispatcher '0x218f492c860'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000218F3C323E0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000218F5D75970>
                     └ <Dispatcher '0x218f492c860'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x218f492c860'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000218F49BDD90>,), 'skip_updates'...
                 │       └ Update(update_id=259321294, message=Message(message_id=9, date=datetime.datetime(2025, 7, 20, 20, 30, 31, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000218F5D99EE0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x218f492c860'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000218F49BDD90>,), 'skip_updates'...
                 │       └ Update(update_id=259321294, message=Message(message_id=9, date=datetime.datetime(2025, 7, 20, 20, 30, 31, tzinfo=TzInfo(UTC))...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000218F5D99F40>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    data.update({"state": context, "raw_state": await context.get_state()})
    │    │                │                           │       └ <function FSMContext.get_state at 0x00000218F3BE8EA0>
    │    │                │                           └ <aiogram.fsm.context.FSMContext object at 0x00000218F5DE8230>
    │    │                └ <aiogram.fsm.context.FSMContext object at 0x00000218F5DE8230>
    │    └ <method 'update' of 'dict' objects>
    └ {'dispatcher': <Dispatcher '0x218f492c860'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000218F49BDD90>,), 'skip_updates'...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\context.py", line 15, in get_state
    return await self.storage.get_state(key=self.key)
                 │    │       │             │    └ StorageKey(bot_id=7986781338, chat_id=6826384730, user_id=6826384730, thread_id=None, business_connection_id=None, destiny='d...
                 │    │       │             └ <aiogram.fsm.context.FSMContext object at 0x00000218F5DE8230>
                 │    │       └ <function RedisStorage.get_state at 0x00000218F3E7DC60>
                 │    └ <aiogram.fsm.storage.redis.RedisStorage object at 0x00000218F5D98B60>
                 └ <aiogram.fsm.context.FSMContext object at 0x00000218F5DE8230>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\storage\redis.py", line 99, in get_state
    value = await self.redis.get(redis_key)
                  │    │     │   └ 'fsm:6826384730:6826384730:state'
                  │    │     └ <function BasicKeyCommands.get at 0x00000218F3DCB4C0>
                  │    └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port...
                  └ <aiogram.fsm.storage.redis.RedisStorage object at 0x00000218F5D98B60>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\client.py", line 672, in execute_command
    conn = self.connection or await pool.get_connection()
           │    │                   │    └ <function ConnectionPool.get_connection at 0x00000218F3D26A20>
           │    │                   └ <redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>)>
           │    └ None
           └ <redis.asyncio.client.Redis(<redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1141, in get_connection
    await self.ensure_connection(connection)
          │    │                 └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
          │    └ <function ConnectionPool.ensure_connection at 0x00000218F3D26C00>
          └ <redis.asyncio.connection.ConnectionPool(<redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 1174, in ensure_connection
    await connection.connect()
          │          └ <function AbstractConnection.connect at 0x00000218F3D249A0>
          └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 296, in connect
    await self.connect_check_health(check_health=True)
          │    └ <function AbstractConnection.connect_check_health at 0x00000218F3D24A40>
          └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\redis\asyncio\connection.py", line 310, in connect_check_health
    raise ConnectionError(self._error_message(e))
          │               │    └ <function AbstractConnection._error_message at 0x00000218F3D24C20>
          │               └ <redis.asyncio.connection.Connection(host=localhost,port=6379,db=0)>
          └ <class 'redis.exceptions.ConnectionError'>

redis.exceptions.ConnectionError: Error 22 connecting to localhost:6379. Удаленный компьютер отклонил это сетевое подключение.
2025-07-20 23:31:41 | INFO | Polling stopped
2025-07-20 23:31:41 | ERROR | Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-07-20 23:31:41 | WARNING | Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7986781338)
2025-07-20 23:31:41 | INFO | Bot stopped
2025-07-20 23:31:41 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 13:31:26 | DEBUG | Using proactor: IocpProactor
2025-07-21 13:31:27 | ERROR | FSM Storage database opening error: unable to open database file
2025-07-21 13:31:27 | INFO | Starting bot...
2025-07-21 13:31:27 | INFO | Start polling
2025-07-21 13:31:38 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 13:31:38 | INFO | Update id=259321295 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 13:31:38 | ERROR | Cause exception while process update id=259321295 by bot id=7986781338
AttributeError: 'SQLStorage' object has no attribute 'con'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 74, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000258FD87AA20>
    │       └ <function run at 0x00000258F64C3560>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000258FDBAFBC0>
           │      └ <function Runner.run at 0x00000258F64E2A20>
           └ <asyncio.runners.Runner object at 0x00000258FDC706E0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:62> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000258F64E05E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000258FDC706E0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000258F6579580>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000258F64E2340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000258F64662A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000258FDC8DE10>()>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000258FDC8DE10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000258FDC8DE10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000258FDC8DE10>()>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000258FDA86420>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321295, message=Message(message_id=10, date=datetime.datetime(2025, 7, 20, 21, 13, 17, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000258FDA86420>
                     │    └ <function Dispatcher.feed_update at 0x00000258FBEAFC40>
                     └ <Dispatcher '0x258fdb9d0d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000258FBEAE3E0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000258FDC72360>
                     └ <Dispatcher '0x258fdb9d0d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000258FDA86420>,), 'skip_updates'...
                 │       └ Update(update_id=259321295, message=Message(message_id=10, date=datetime.datetime(2025, 7, 20, 21, 13, 17, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000258FDC72480>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000258FDA86420>,), 'skip_updates'...
                 │       └ Update(update_id=259321295, message=Message(message_id=10, date=datetime.datetime(2025, 7, 20, 21, 13, 17, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000258FDC724E0>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 40, in __call__
    data.update({"state": context, "raw_state": await context.get_state()})
    │    │                │                           │       └ <function FSMContext.get_state at 0x00000258FBE59D00>
    │    │                │                           └ <aiogram.fsm.context.FSMContext object at 0x00000258FDC8E9F0>
    │    │                └ <aiogram.fsm.context.FSMContext object at 0x00000258FDC8E9F0>
    │    └ <method 'update' of 'dict' objects>
    └ {'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000258FDA86420>,), 'skip_updates'...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\context.py", line 15, in get_state
    return await self.storage.get_state(key=self.key)
                 │    │       │             │    └ StorageKey(bot_id=7986781338, chat_id=6826384730, user_id=6826384730, thread_id=None, destiny='default')
                 │    │       │             └ <aiogram.fsm.context.FSMContext object at 0x00000258FDC8E9F0>
                 │    │       └ <function SQLStorage.get_state at 0x00000258FBEC1300>
                 │    └ <aiogram_sqlite_storage.sqlitestore.SQLStorage object at 0x00000258FD8E4560>
                 └ <aiogram.fsm.context.FSMContext object at 0x00000258FDC8E9F0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram_sqlite_storage\sqlitestore.py", line 103, in get_state
    s_state = self.con.execute("SELECT state FROM fsm_data WHERE key = ?", (s_key,)).fetchone()
              │                                                             └ '7986781338:6826384730:6826384730'
              └ <aiogram_sqlite_storage.sqlitestore.SQLStorage object at 0x00000258FD8E4560>

AttributeError: 'SQLStorage' object has no attribute 'con'
2025-07-21 13:33:12 | INFO | Polling stopped
2025-07-21 13:33:13 | ERROR | Bot stopped with error: 'SQLStorage' object has no attribute 'con'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 543, in start_polling
    done, pending = await asyncio.wait(tasks, return_when=asyncio.FIRST_COMPLETED)
                          │       │    │                  │       └ 'FIRST_COMPLETED'
                          │       │    │                  └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....
                          │       │    └ [<Task pending name='Task-2' coro=<Dispatcher._polling() running at C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\d...
                          │       └ <function wait at 0x00000258F64DC9A0>
                          └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\tasks.py", line 464, in wait
    return await _wait(fs, timeout, return_when, loop)
                 │     │   │        │            └ <ProactorEventLoop running=True closed=False debug=False>
                 │     │   │        └ 'FIRST_COMPLETED'
                 │     │   └ None
                 │     └ {<Task pending name='Task-2' coro=<Dispatcher._polling() running at C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\d...
                 └ <function _wait at 0x00000258F64DCB80>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\tasks.py", line 550, in _wait
    await waiter
          └ <Future cancelled>

asyncio.exceptions.CancelledError


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 74, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000258FD87AA20>
    │       └ <function run at 0x00000258F64C3560>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000258FDBAFBC0>
           │      └ <function Runner.run at 0x00000258F64E2A20>
           └ <asyncio.runners.Runner object at 0x00000258FDC706E0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task cancelling name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:68> cb=[_run_until_complete_cb() at C:...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000258F64E05E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000258FDC706E0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000258F6579580>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000258F64E2340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000258F64662A0>
    └ <Handle Task.task_wakeup(<_GatheringFu...result=[None]>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<_GatheringFu...result=[None]>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<_GatheringFu...result=[None]>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<_GatheringFu...result=[None]>)>

> File "C:\Projects\Taxi_Tg_Bot\main.py", line 62, in main
    await dp.start_polling(
          │  └ <function Dispatcher.start_polling at 0x00000258FBEC0360>
          └ <Dispatcher '0x258fdb9d0d0'>

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 556, in start_polling
    await self.emit_shutdown(bot=bots[-1], **workflow_data)
          │    │                 │           └ {'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000258FDA86420>,), 'skip_updates'...
          │    │                 └ (<aiogram.client.bot.Bot object at 0x00000258FDA86420>,)
          │    └ <function Router.emit_shutdown at 0x00000258FBEAF7E0>
          └ <Dispatcher '0x258fdb9d0d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 255, in emit_shutdown
    await self.shutdown.trigger(*args, **kwargs)
          │    │        │        │       └ {'bot': <aiogram.client.bot.Bot object at 0x00000258FDA86420>, 'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram....
          │    │        │        └ ()
          │    │        └ <function EventObserver.trigger at 0x00000258FBEAEFC0>
          │    └ <aiogram.dispatcher.event.event.EventObserver object at 0x00000258FDC72390>
          └ <Dispatcher '0x258fdb9d0d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\event.py", line 42, in trigger
    await handler.call(*args, **kwargs)
          │       │     │       └ {'bot': <aiogram.client.bot.Bot object at 0x00000258FDA86420>, 'dispatcher': <Dispatcher '0x258fdb9d0d0'>, 'bots': (<aiogram....
          │       │     └ ()
          │       └ <function CallableObject.call at 0x00000258FBEAD300>
          └ HandlerObject(callback=<bound method FSMContextMiddleware.close of <aiogram.fsm.middleware.FSMContextMiddleware object at 0x0...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method FSMContextMiddleware.close of <aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 110, in close
    await self.storage.close()
          │    │       └ <function SQLStorage.close at 0x00000258FBEC1580>
          │    └ <aiogram_sqlite_storage.sqlitestore.SQLStorage object at 0x00000258FD8E4560>
          └ <aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000258FDC724E0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram_sqlite_storage\sqlitestore.py", line 177, in close
    self.con.close()
    └ <aiogram_sqlite_storage.sqlitestore.SQLStorage object at 0x00000258FD8E4560>

AttributeError: 'SQLStorage' object has no attribute 'con'
2025-07-21 13:33:13 | INFO | Bot stopped
2025-07-21 13:33:13 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 13:33:19 | DEBUG | Using proactor: IocpProactor
2025-07-21 13:33:19 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 13:33:19 | INFO | Starting bot...
2025-07-21 13:33:19 | INFO | Start polling
2025-07-21 13:33:31 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 13:33:59 | INFO | Update id=259321296 is not handled. Duration 32 ms by bot id=7986781338
2025-07-21 13:33:59 | ERROR | Cause exception while process update id=259321296 by bot id=7986781338
ValidationError: 1 validation error for ReplyKeyboardMarkup
keyboard
  Field required [type=missing, input_value={'resize_keyboard': True}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 74, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000237F33DAA20>
    │       └ <function run at 0x00000237EC073560>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000237F372FBC0>
           │      └ <function Runner.run at 0x00000237EC08EA20>
           └ <asyncio.runners.Runner object at 0x00000237F37F0410>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:62> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000237EC08C5E0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000237F37F0410>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000237EC129580>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000237EC08E340>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000237EC0162A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000237F1A43040>()>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000237F1A43040>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000237F1A43040>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000237F1A43040>()>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321296, message=Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000237F3641250>
                     │    └ <function Dispatcher.feed_update at 0x00000237F19EFC40>
                     └ <Dispatcher '0x237f37f07d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000237F19EE3E0>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000237F37F2270>
                     └ <Dispatcher '0x237f37f07d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │       └ Update(update_id=259321296, message=Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000237F37F23C0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │       └ Update(update_id=259321296, message=Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000237F37F2420>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │       └ Update(update_id=259321296, message=Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)...
                 └ <function TelegramEventObserver.trigger at 0x00000237F3816840>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │             └ Update(update_id=259321296, message=Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)...
                 └ <function CallableObject.call at 0x00000237F3845620>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x237f37f07d0'>>, Update(update_id=259321296, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x00000237F19EF240>
                 └ <Dispatcher '0x237f37f07d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000237F3845C60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000237F19EE3E0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000237F3441010>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000237F19EF2E0>
                 └ <Dispatcher '0x237f37f07d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x00000237F19EF240>
                     └ <Router '0x237f38202c0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000237F3845E40>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000237F19EE3E0>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000237F3820320>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000237F19EF2E0>
                 └ <Router '0x237f38202c0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                     │        │       └ Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │        └ <function TelegramEventObserver.trigger at 0x00000237F19EE520>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000237F3820320>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x237f37f07d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000237F3641250>,), 'skip_updates'...
                 │             └ Message(message_id=11, date=datetime.datetime(2025, 7, 21, 10, 33, 59, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 └ <function CallableObject.call at 0x00000237F3845EE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function start_command at 0x00000237EE143C40>, Message(message_id=11, date=datetime.datetime(2025, 7, 21, ...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\common\start.py", line 34, in start_command
    reply_markup=static.get_main_kb(user.telegram_id)
                 │      │           │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000237F33198A0>
                 │      │           └ <database.models.User object at 0x00000237F3423230>
                 │      └ <function get_main_kb at 0x00000237EE141A80>
                 └ <module 'bot.keyboards.static' from 'C:\\Projects\\Taxi_Tg_Bot\\bot\\keyboards\\static.py'>

  File "C:\Projects\Taxi_Tg_Bot\bot\keyboards\static.py", line 5, in get_main_kb
    kb = ReplyKeyboardMarkup(resize_keyboard=True)
         └ <class 'aiogram.types.reply_keyboard_markup.ReplyKeyboardMarkup'>

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\pydantic\main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ ReplyKeyboardMarkup()
    │                 │                      │               └ {'resize_keyboard': True}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="ReplyKeyboardMarkup", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validat...
    └ ReplyKeyboardMarkup()

pydantic_core._pydantic_core.ValidationError: 1 validation error for ReplyKeyboardMarkup
keyboard
  Field required [type=missing, input_value={'resize_keyboard': True}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.5/v/missing
2025-07-21 13:38:20 | INFO | Polling stopped
2025-07-21 13:38:20 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 13:38:20 | INFO | Bot stopped
2025-07-21 13:38:20 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 13:38:26 | DEBUG | Using proactor: IocpProactor
2025-07-21 13:38:27 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 13:38:27 | INFO | Starting bot...
2025-07-21 13:38:27 | INFO | Start polling
2025-07-21 13:38:38 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 13:38:44 | INFO | Update id=259321297 is handled. Duration 483 ms by bot id=7986781338
2025-07-21 13:39:03 | INFO | Update id=259321298 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 13:39:11 | INFO | Update id=259321299 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 13:44:06 | INFO | Polling stopped
2025-07-21 13:44:06 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 13:44:06 | INFO | Bot stopped
2025-07-21 13:44:06 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 14:21:38 | DEBUG | Using proactor: IocpProactor
2025-07-21 14:21:38 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 14:21:38 | INFO | Starting bot...
2025-07-21 14:21:38 | INFO | Start polling
2025-07-21 14:21:39 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 14:21:45 | INFO | Update id=259321300 is not handled. Duration 31 ms by bot id=7986781338
2025-07-21 14:21:45 | ERROR | Cause exception while process update id=259321300 by bot id=7986781338
NameError: name 'YOUR_TELEGRAM_USER_ID_HERE' is not defined
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 74, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000282583760C0>
    │       └ <function run at 0x000002824E9FC680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000002825873AAC0>
           │      └ <function Runner.run at 0x0000028251119F80>
           └ <asyncio.runners.Runner object at 0x000002825316DEE0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:62> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000028251117B00>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002825316DEE0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000028251194AE0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000282511198A0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000282510A5800>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000282587AFA00>()>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000282587AFA00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000282587AFA00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000282587AFA00>()>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321300, message=Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000282586E7260>
                     │    └ <function Dispatcher.feed_update at 0x00000282569D3560>
                     └ <Dispatcher '0x2825316e2d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000282569D1D00>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002825316FE60>
                     └ <Dispatcher '0x2825316e2d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │       └ Update(update_id=259321300, message=Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002825316FFB0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │       └ Update(update_id=259321300, message=Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002825316FF80>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │       └ Update(update_id=259321300, message=Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)...
                 └ <function TelegramEventObserver.trigger at 0x00000282587BF920>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │             └ Update(update_id=259321300, message=Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)...
                 └ <function CallableObject.call at 0x00000282587BCCC0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2825316e2d0'>>, Update(update_id=259321300, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x00000282569D2B60>
                 └ <Dispatcher '0x2825316e2d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000282589A0040>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000282569D1D00>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002825316E360>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000282569D2C00>
                 └ <Dispatcher '0x2825316e2d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x00000282569D2B60>
                     └ <Router '0x282587adf10'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000282589A0180>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000282569D1D00>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000282587ADF70>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000282569D2C00>
                 └ <Router '0x282587adf10'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                     │        │       └ Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │        └ <function TelegramEventObserver.trigger at 0x00000282569D1E40>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000282587ADF70>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x2825316e2d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000282586E7260>,), 'skip_updates'...
                 │             └ Message(message_id=16, date=datetime.datetime(2025, 7, 21, 11, 21, 45, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 └ <function CallableObject.call at 0x00000282589A0220>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function start_command at 0x000002825311DE40>, Message(message_id=16, date=datetime.datetime(2025, 7, 21, ...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\common\start.py", line 34, in start_command
    reply_markup=static.get_main_kb(user.telegram_id)
                 │      │           │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x00000282583011C0>
                 │      │           └ <database.models.User object at 0x00000282589BBDA0>
                 │      └ <function get_main_kb at 0x0000028258793CE0>
                 └ <module 'bot.keyboards.static' from 'C:\\Projects\\Taxi_Tg_Bot\\bot\\keyboards\\static.py'>

  File "C:\Projects\Taxi_Tg_Bot\bot\keyboards\static.py", line 10, in get_main_kb
    if user_id in [123, 456, YOUR_TELEGRAM_USER_ID_HERE]:  # Пример: заменить на реальную проверку
       └ 6826384730

NameError: name 'YOUR_TELEGRAM_USER_ID_HERE' is not defined
2025-07-21 14:21:57 | INFO | Update id=259321301 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 14:21:59 | INFO | Update id=259321302 is handled. Duration 421 ms by bot id=7986781338
2025-07-21 14:30:04 | INFO | Polling stopped
2025-07-21 14:30:04 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 14:30:04 | INFO | Bot stopped
2025-07-21 14:30:04 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 14:30:14 | DEBUG | Using proactor: IocpProactor
2025-07-21 14:30:15 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 14:30:15 | INFO | Starting bot...
2025-07-21 14:30:15 | INFO | Start polling
2025-07-21 14:30:27 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 14:30:40 | INFO | Update id=259321303 is handled. Duration 437 ms by bot id=7986781338
2025-07-21 14:30:45 | INFO | Update id=259321304 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 14:30:52 | INFO | Update id=259321305 is handled. Duration 155 ms by bot id=7986781338
2025-07-21 14:31:01 | INFO | Update id=259321306 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 14:31:13 | INFO | Polling stopped
2025-07-21 14:31:13 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 14:31:13 | INFO | Bot stopped
2025-07-21 14:31:13 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:43:15 | DEBUG | Using proactor: IocpProactor
2025-07-21 17:43:16 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 17:43:16 | INFO | Starting bot...
2025-07-21 17:43:16 | INFO | Start polling
2025-07-21 17:43:16 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:43:16 | INFO | Update id=259321307 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:43:22 | INFO | Update id=259321308 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:43:25 | INFO | Update id=259321309 is handled. Duration 312 ms by bot id=7986781338
2025-07-21 17:43:26 | INFO | Update id=259321310 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:43:32 | INFO | Update id=259321311 is not handled. Duration 31 ms by bot id=7986781338
2025-07-21 17:43:34 | INFO | Update id=259321312 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:43:35 | INFO | Update id=259321313 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:43:36 | INFO | Update id=259321314 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:43:37 | INFO | Update id=259321315 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 17:44:01 | INFO | Polling stopped
2025-07-21 17:44:01 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 17:44:01 | INFO | Bot stopped
2025-07-21 17:44:01 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:47:29 | DEBUG | Using proactor: IocpProactor
2025-07-21 17:47:30 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 17:47:30 | INFO | Starting bot...
2025-07-21 17:47:30 | INFO | Start polling
2025-07-21 17:47:30 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:47:35 | INFO | Update id=259321316 is handled. Duration 250 ms by bot id=7986781338
2025-07-21 17:47:45 | INFO | Update id=259321317 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:47:50 | INFO | Update id=259321318 is handled. Duration 186 ms by bot id=7986781338
2025-07-21 17:47:59 | INFO | Update id=259321319 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 17:48:56 | INFO | Polling stopped
2025-07-21 17:48:56 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 17:48:56 | INFO | Bot stopped
2025-07-21 17:48:56 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:51:33 | DEBUG | Using proactor: IocpProactor
2025-07-21 17:51:34 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 17:51:34 | INFO | Starting bot...
2025-07-21 17:51:34 | INFO | Start polling
2025-07-21 17:51:34 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:51:40 | INFO | Update id=259321320 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 17:51:40 | ERROR | Cause exception while process update id=259321320 by bot id=7986781338
AttributeError: 'State' object has no attribute 'set'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 75, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000014FB64B60C0>
    │       └ <function run at 0x0000014FACADC680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000014FB685ABD0>
           │      └ <function Runner.run at 0x0000014FAF199F80>
           └ <asyncio.runners.Runner object at 0x0000014FB11DF200>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:63> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000014FAF197B00>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000014FB11DF200>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000014FAF234AE0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000014FAF1998A0>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000014FAF125800>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321320, message=Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x0000014FB6638770>
                     │    └ <function Dispatcher.feed_update at 0x0000014FB4B33560>
                     └ <Dispatcher '0x14fb11df4d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000014FB4B31D00>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000014FB68C9160>
                     └ <Dispatcher '0x14fb11df4d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │       └ Update(update_id=259321320, message=Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000014FB67FA480>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │       └ Update(update_id=259321320, message=Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000014FB68C9310>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │       └ Update(update_id=259321320, message=Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)...
                 └ <function TelegramEventObserver.trigger at 0x0000014FB68E1800>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │             └ Update(update_id=259321320, message=Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)...
                 └ <function CallableObject.call at 0x0000014FB68E1A80>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x14fb11df4d0'>>, Update(update_id=259321320, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x0000014FB4B32B60>
                 └ <Dispatcher '0x14fb11df4d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000014FB6950D60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000014FB4B31D00>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000014FB11DF620>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000014FB4B32C00>
                 └ <Dispatcher '0x14fb11df4d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x0000014FB4B32B60>
                     └ <Router '0x14fb68ca270'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000014FB68E2AC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000014FB4B31D00>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000014FB68CA2D0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000014FB4B32C00>
                 └ <Router '0x14fb68ca270'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                     │        │       └ Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │        └ <function TelegramEventObserver.trigger at 0x0000014FB4B31E40>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000014FB68CA2D0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x14fb11df4d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000014FB6638770>,), 'skip_updates'...
                 │             └ Message(message_id=42, date=datetime.datetime(2025, 7, 21, 14, 51, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 └ <function CallableObject.call at 0x0000014FB6950FE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function create_order_start at 0x0000014FB6555440>, Message(message_id=42, date=datetime.datetime(2025, 7,...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 14, in create_order_start
    await OrderCreation.START_POINT.set()
          │             └ <State 'OrderCreation:START_POINT'>
          └ <class 'bot.states.order_creation.OrderCreation'>

AttributeError: 'State' object has no attribute 'set'
2025-07-21 17:51:45 | INFO | Update id=259321321 is handled. Duration 217 ms by bot id=7986781338
2025-07-21 17:52:52 | INFO | Polling stopped
2025-07-21 17:52:52 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 17:52:52 | INFO | Bot stopped
2025-07-21 17:52:52 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:52:58 | DEBUG | Using proactor: IocpProactor
2025-07-21 17:52:59 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 17:52:59 | INFO | Starting bot...
2025-07-21 17:52:59 | INFO | Start polling
2025-07-21 17:52:59 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:53:03 | INFO | Update id=259321322 is handled. Duration 327 ms by bot id=7986781338
2025-07-21 17:53:05 | INFO | Update id=259321323 is handled. Duration 94 ms by bot id=7986781338
2025-07-21 17:58:07 | DEBUG | Using proactor: IocpProactor
2025-07-21 17:58:07 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 17:58:08 | INFO | Starting bot...
2025-07-21 17:58:08 | INFO | Start polling
2025-07-21 17:58:08 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:58:13 | INFO | Update id=259321324 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:58:13 | ERROR | Cause exception while process update id=259321324 by bot id=7986781338
AttributeError: 'FSMContext' object has no attribute 'proxy'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 66, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001998167A020>
    │       └ <function run at 0x00000199F7CFC680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000019981A0FB50>
           │      └ <function Runner.run at 0x00000199FA409EE0>
           └ <asyncio.runners.Runner object at 0x0000019981A8AE10>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:54> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000199FA407A60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000019981A8AE10>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000199FA484A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000199FA409800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000199FA395760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321324, message=Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x0000019981919700>
                     │    └ <function Dispatcher.feed_update at 0x00000199FFC6F4C0>
                     └ <Dispatcher '0x19981a428d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000199FFC6DC60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000019981AB0AD0>
                     └ <Dispatcher '0x19981a428d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │       └ Update(update_id=259321324, message=Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000019981AB0BF0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │       └ Update(update_id=259321324, message=Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000019981AB0C50>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │       └ Update(update_id=259321324, message=Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)...
                 └ <function TelegramEventObserver.trigger at 0x0000019981AB5BC0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │             └ Update(update_id=259321324, message=Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)...
                 └ <function CallableObject.call at 0x0000019981B1C860>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x19981a428d0'>>, Update(update_id=259321324, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x00000199FFC6EAC0>
                 └ <Dispatcher '0x19981a428d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000019981B1CEA0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000199FFC6DC60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000019981A8B3B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000199FFC6EB60>
                 └ <Dispatcher '0x19981a428d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x00000199FFC6EAC0>
                     └ <Router '0x199fc466090'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000019981AB5940>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000199FFC6DC60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000199FC4660C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000199FFC6EB60>
                 └ <Router '0x199fc466090'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                     │        │       └ Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │        └ <function TelegramEventObserver.trigger at 0x00000199FFC6DDA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000199FC4660C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x19981a428d0'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000019981919700>,), 'skip_updates'...
                 │             └ Message(message_id=49, date=datetime.datetime(2025, 7, 21, 14, 58, 13, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 └ <function CallableObject.call at 0x0000019981B1D120>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_start_point at 0x00000199FC3CACA0>, Message(message_id=49, date=datetime.datetime(2025, 7...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 25, in process_start_point
    async with state.proxy() as data:
               └ <aiogram.fsm.context.FSMContext object at 0x0000019981AB31A0>

AttributeError: 'FSMContext' object has no attribute 'proxy'
2025-07-21 17:59:03 | INFO | Polling stopped
2025-07-21 17:59:03 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 17:59:03 | ERROR | Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2685)
2025-07-21 17:59:03 | WARNING | Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7986781338)
2025-07-21 17:59:03 | INFO | Bot stopped
2025-07-21 17:59:03 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:59:10 | DEBUG | Using proactor: IocpProactor
2025-07-21 17:59:11 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 17:59:11 | INFO | Starting bot...
2025-07-21 17:59:11 | INFO | Start polling
2025-07-21 17:59:11 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 17:59:16 | ERROR | Deserializing error! Probably, unsupported serializing method was used. a bytes-like object is required, not 'NoneType'
2025-07-21 17:59:16 | INFO | Update id=259321325 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 17:59:16 | ERROR | Cause exception while process update id=259321325 by bot id=7986781338
TypeError: 'NoneType' object does not support item assignment
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 66, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000002490E6AA020>
    │       └ <function run at 0x0000024904D2C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000002490EA2FB50>
           │      └ <function Runner.run at 0x0000024907379EE0>
           └ <asyncio.runners.Runner object at 0x000002490EAB2FF0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:54> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000024907377A60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002490EAB2FF0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000024907414A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000024907379800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000024907305760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321325, message=Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x000002490E792BD0>
                     │    └ <function Dispatcher.feed_update at 0x000002490CD1F4C0>
                     └ <Dispatcher '0x2490eab3110'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002490CD1DC60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002490E67F170>
                     └ <Dispatcher '0x2490eab3110'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321325, message=Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002490EAD0E00>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321325, message=Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000002490EAD0E60>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321325, message=Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)...
                 └ <function TelegramEventObserver.trigger at 0x000002490EADDD00>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │             └ Update(update_id=259321325, message=Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)...
                 └ <function CallableObject.call at 0x000002490EB2C9A0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2490eab3110'>>, Update(update_id=259321325, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x000002490CD1EAC0>
                 └ <Dispatcher '0x2490eab3110'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002490EB2CFE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002490CD1DC60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002490EAB30E0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002490CD1EB60>
                 └ <Dispatcher '0x2490eab3110'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x000002490CD1EAC0>
                     └ <Router '0x2490e89dc40'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002490EADDA80>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000002490CD1DC60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002490940DCA0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000002490CD1EB60>
                 └ <Router '0x2490e89dc40'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                     │        │       └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │        └ <function TelegramEventObserver.trigger at 0x000002490CD1DDA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002490940DCA0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x2490eab3110'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002490E792BD0>,), 'skip_updates'...
                 │             └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 └ <function CallableObject.call at 0x000002490EB2D300>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_start_point at 0x000002490941ADE0>, Message(message_id=50, date=datetime.datetime(2025, 7...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 26, in process_start_point
    data['start_point'] = message.text
    │                     │       └ '/start'
    │                     └ Message(message_id=50, date=datetime.datetime(2025, 7, 21, 14, 59, 15, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
    └ None

TypeError: 'NoneType' object does not support item assignment
2025-07-21 18:00:10 | INFO | Polling stopped
2025-07-21 18:00:10 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:00:10 | INFO | Bot stopped
2025-07-21 18:00:10 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:00:17 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:00:18 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:00:18 | INFO | Starting bot...
2025-07-21 18:00:18 | INFO | Start polling
2025-07-21 18:00:18 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:00:22 | ERROR | Deserializing error! Probably, unsupported serializing method was used. a bytes-like object is required, not 'NoneType'
2025-07-21 18:00:22 | INFO | Update id=259321326 is handled. Duration 250 ms by bot id=7986781338
2025-07-21 18:02:06 | INFO | Polling stopped
2025-07-21 18:02:06 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:02:06 | INFO | Bot stopped
2025-07-21 18:02:06 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:06:23 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:06:24 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:06:24 | INFO | Starting bot...
2025-07-21 18:06:24 | INFO | Start polling
2025-07-21 18:06:24 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:06:34 | INFO | Update id=259321327 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 18:06:44 | INFO | Update id=259321328 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:07:14 | INFO | Polling stopped
2025-07-21 18:07:14 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:07:15 | INFO | Bot stopped
2025-07-21 18:07:15 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:08:32 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:08:32 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:08:32 | INFO | Starting bot...
2025-07-21 18:08:32 | INFO | Start polling
2025-07-21 18:08:33 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:08:36 | INFO | Update id=259321329 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:08:46 | INFO | Polling stopped
2025-07-21 18:08:46 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:08:46 | ERROR | Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2685)
2025-07-21 18:08:46 | WARNING | Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7986781338)
2025-07-21 18:08:46 | INFO | Bot stopped
2025-07-21 18:08:46 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:09:50 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:09:51 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:09:51 | INFO | Starting bot...
2025-07-21 18:09:51 | INFO | Start polling
2025-07-21 18:09:51 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:09:54 | INFO | Update id=259321330 is not handled. Duration 47 ms by bot id=7986781338
2025-07-21 18:10:00 | INFO | Polling stopped
2025-07-21 18:10:00 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:10:01 | INFO | Bot stopped
2025-07-21 18:10:01 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:11:46 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:11:47 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:11:47 | INFO | Starting bot...
2025-07-21 18:11:47 | INFO | Start polling
2025-07-21 18:11:47 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:11:52 | INFO | Update id=259321331 is handled. Duration 282 ms by bot id=7986781338
2025-07-21 18:12:00 | INFO | Update id=259321332 is handled. Duration 78 ms by bot id=7986781338
2025-07-21 18:12:02 | INFO | Update id=259321333 is handled. Duration 94 ms by bot id=7986781338
2025-07-21 18:12:04 | INFO | Update id=259321334 is handled. Duration 203 ms by bot id=7986781338
2025-07-21 18:12:05 | INFO | Update id=259321335 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:12:07 | INFO | Update id=259321336 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 18:12:08 | INFO | Update id=259321337 is handled. Duration 172 ms by bot id=7986781338
2025-07-21 18:12:09 | INFO | Update id=259321338 is handled. Duration 78 ms by bot id=7986781338
2025-07-21 18:12:11 | INFO | Update id=259321339 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:12:12 | INFO | Update id=259321340 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:12:13 | INFO | Update id=259321341 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 18:12:18 | INFO | Update id=259321342 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:12:20 | INFO | Update id=259321343 is handled. Duration 61 ms by bot id=7986781338
2025-07-21 18:12:22 | INFO | Update id=259321344 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:12:48 | INFO | Update id=259321345 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:14:12 | INFO | Polling stopped
2025-07-21 18:14:12 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:14:13 | INFO | Bot stopped
2025-07-21 18:14:13 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:14:58 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:14:59 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:14:59 | INFO | Starting bot...
2025-07-21 18:14:59 | INFO | Start polling
2025-07-21 18:14:59 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:15:04 | INFO | Update id=259321346 is handled. Duration 233 ms by bot id=7986781338
2025-07-21 18:16:52 | INFO | Update id=259321347 is handled. Duration 188 ms by bot id=7986781338
2025-07-21 18:16:53 | INFO | Update id=259321348 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:16:56 | INFO | Update id=259321349 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:16:57 | INFO | Update id=259321350 is handled. Duration 188 ms by bot id=7986781338
2025-07-21 18:16:59 | INFO | Update id=259321351 is handled. Duration 78 ms by bot id=7986781338
2025-07-21 18:17:00 | INFO | Update id=259321352 is handled. Duration 375 ms by bot id=7986781338
2025-07-21 18:17:02 | INFO | Update id=259321353 is handled. Duration 109 ms by bot id=7986781338
2025-07-21 18:19:45 | INFO | Polling stopped
2025-07-21 18:19:45 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:19:45 | INFO | Bot stopped
2025-07-21 18:19:45 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:19:51 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:19:52 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:19:52 | INFO | Starting bot...
2025-07-21 18:19:52 | INFO | Start polling
2025-07-21 18:19:52 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:19:58 | INFO | Update id=259321354 is handled. Duration 296 ms by bot id=7986781338
2025-07-21 18:20:00 | INFO | Update id=259321355 is handled. Duration 266 ms by bot id=7986781338
2025-07-21 18:20:03 | INFO | Update id=259321356 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:20:06 | INFO | Update id=259321357 is handled. Duration 344 ms by bot id=7986781338
2025-07-21 18:20:11 | INFO | Update id=259321358 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:20:13 | INFO | Update id=259321359 is handled. Duration 313 ms by bot id=7986781338
2025-07-21 18:20:17 | INFO | Update id=259321360 is handled. Duration 140 ms by bot id=7986781338
2025-07-21 18:20:20 | INFO | Update id=259321361 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:20:21 | INFO | Update id=259321362 is handled. Duration 155 ms by bot id=7986781338
2025-07-21 18:20:26 | INFO | Polling stopped
2025-07-21 18:20:26 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:20:26 | INFO | Bot stopped
2025-07-21 18:20:26 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:22:13 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:22:13 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:22:13 | INFO | Starting bot...
2025-07-21 18:22:13 | INFO | Start polling
2025-07-21 18:22:14 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:22:14 | INFO | Update id=259321363 is handled. Duration 265 ms by bot id=7986781338
2025-07-21 18:22:29 | INFO | Update id=259321364 is handled. Duration 219 ms by bot id=7986781338
2025-07-21 18:22:51 | INFO | Update id=259321365 is handled. Duration 328 ms by bot id=7986781338
2025-07-21 18:23:00 | INFO | Update id=259321366 is handled. Duration 61 ms by bot id=7986781338
2025-07-21 18:23:17 | INFO | Update id=259321367 is handled. Duration 188 ms by bot id=7986781338
2025-07-21 18:23:29 | INFO | Update id=259321368 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:23:29 | ERROR | Cause exception while process update id=259321368 by bot id=7986781338
AttributeError: module 'bot.keyboards.inline' has no attribute 'get_order_confirmation_kb'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000272AB8BA020>
    │       └ <function run at 0x00000272A1F8C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000272ABC5FF10>
           │      └ <function Runner.run at 0x00000272A45C1EE0>
           └ <asyncio.runners.Runner object at 0x00000272AB99DC70>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000272A45BBA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000272AB99DC70>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000272A4654A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000272A45C1800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000272A4545760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321368, message=Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>
                     │    └ <function Dispatcher.feed_update at 0x00000272A9EE34C0>
                     └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000272A9EE1C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABD01E50>
                     └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321368, message=Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000272ABC93290>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321368, message=Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000272ABD02000>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321368, message=Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC...
                 └ <function TelegramEventObserver.trigger at 0x00000272ABD5DA80>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │             └ Update(update_id=259321368, message=Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC...
                 └ <function CallableObject.call at 0x00000272ABD5E520>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x272aba75a00'>>, Update(update_id=259321368, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x00000272A9EE2AC0>
                 └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000272ABD5E160>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000272A9EE1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABB36720>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000272A9EE2B60>
                 └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x00000272A9EE2AC0>
                     └ <Router '0x272a664e480'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000272ABD19C60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000272A9EE1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272A664E4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000272A9EE2B60>
                 └ <Router '0x272a664e480'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                     │        │       └ Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                     │        └ <function TelegramEventObserver.trigger at 0x00000272A9EE1DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272A664E4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │             └ Message(message_id=126, date=datetime.datetime(2025, 7, 21, 15, 23, 29, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 └ <function CallableObject.call at 0x00000272ABD5F420>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function process_price at 0x00000272A665B420>, Message(message_id=126, date=datetime.datetime(2025, 7, 21,...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 74, in process_price
    reply_markup=inline.get_order_confirmation_kb()
                 └ <module 'bot.keyboards.inline' from 'C:\\Projects\\Taxi_Tg_Bot\\bot\\keyboards\\inline\\__init__.py'>

AttributeError: module 'bot.keyboards.inline' has no attribute 'get_order_confirmation_kb'
2025-07-21 18:24:24 | INFO | Update id=259321369 is handled. Duration 313 ms by bot id=7986781338
2025-07-21 18:24:26 | INFO | Update id=259321370 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:24:34 | INFO | Update id=259321371 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:24:49 | INFO | Update id=259321372 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:24:55 | INFO | Update id=259321373 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:25:05 | INFO | Update id=259321374 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 18:25:05 | ERROR | Cause exception while process update id=259321374 by bot id=7986781338
AttributeError: 'NoneType' object has no attribute 'lower'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000272AB8BA020>
    │       └ <function run at 0x00000272A1F8C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x00000272ABC5FF10>
           │      └ <function Runner.run at 0x00000272A45C1EE0>
           └ <asyncio.runners.Runner object at 0x00000272AB99DC70>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000272A45BBA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000272AB99DC70>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000272A4654A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000272A45C1800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000272A4545760>
    └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321374, message=Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>
                     │    └ <function Dispatcher.feed_update at 0x00000272A9EE34C0>
                     └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000272A9EE1C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABD01E50>
                     └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321374, message=Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x00000272ABC93290>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321374, message=Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x00000272ABD02000>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321374, message=Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)...
                 └ <function TelegramEventObserver.trigger at 0x00000272ABCE3880>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │             └ Update(update_id=259321374, message=Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)...
                 └ <function CallableObject.call at 0x00000272ABD5DA80>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x272aba75a00'>>, Update(update_id=259321374, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x00000272A9EE2AC0>
                 └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000272ABD5F100>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000272A9EE1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABB36720>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000272A9EE2B60>
                 └ <Dispatcher '0x272aba75a00'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x00000272A9EE2AC0>
                     └ <Router '0x272abcddca0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x00000272ABD5FF60>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000272A9EE1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABCDDC40>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000272A9EE2B60>
                 └ <Router '0x272abcddca0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                     │        │       └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                     │        └ <function TelegramEventObserver.trigger at 0x00000272A9EE1DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABCDDC40>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 113, in trigger
    result, data = await handler.check(event, **kwargs)
                         │       │     │        └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                         │       │     └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
                         │       └ <function HandlerObject.check at 0x00000272A9EE1440>
                         └ HandlerObject(callback=<function handle_feedback at 0x00000272ABCE23E0>, awaitable=True, params={'message'}, varkw=False, fil...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 94, in check
    check = await event_filter.call(*args, **kwargs)
                  │            │     │       └ {'dispatcher': <Dispatcher '0x272aba75a00'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000272ABB6ABD0>,), 'skip_updates'...
                  │            │     └ (Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                  │            └ <function CallableObject.call at 0x00000272A9EE0B80>
                  └ FilterObject(callback=<function <lambda> at 0x00000272ABCE22A0>, awaitable=False, params={'message'}, varkw=False, magic=None)
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 48, in call
    return await loop.run_in_executor(None, wrapped)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x00000272ABF6A940>, functools.partial(<function <la...
                 │    └ <function BaseEventLoop.run_in_executor at 0x00000272A45C0360>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\common\feedback.py", line 5, in <lambda>
    @router.message(lambda message: "отзыв" in message.text.lower())
     │      │              │                   │       └ None
     │      │              │                   └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
     │      │              └ Message(message_id=136, date=datetime.datetime(2025, 7, 21, 15, 25, 5, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='pr...
     │      └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x00000272ABCDDC40>
     └ <Router '0x272abcddca0'>

AttributeError: 'NoneType' object has no attribute 'lower'
2025-07-21 18:27:24 | INFO | Polling stopped
2025-07-21 18:27:24 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:27:24 | INFO | Bot stopped
2025-07-21 18:27:24 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:27:31 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:27:32 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:27:32 | INFO | Starting bot...
2025-07-21 18:27:32 | INFO | Start polling
2025-07-21 18:27:32 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:27:35 | INFO | Update id=259321375 is handled. Duration 297 ms by bot id=7986781338
2025-07-21 18:27:36 | INFO | Update id=259321376 is handled. Duration 140 ms by bot id=7986781338
2025-07-21 18:27:44 | INFO | Update id=259321377 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 18:27:53 | INFO | Update id=259321378 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:28:03 | INFO | Update id=259321379 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:28:07 | INFO | Update id=259321380 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:28:16 | INFO | Update id=259321381 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 18:28:16 | ERROR | Cause exception while process update id=259321381 by bot id=7986781338
AttributeError: 'FSMContext' object has no attribute 'finish'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001B96DC0A020>
    │       └ <function run at 0x000001B96422C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001B96DFAFF10>
           │      └ <function Runner.run at 0x000001B966911EE0>
           └ <asyncio.runners.Runner object at 0x000001B96E04C050>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001B96690BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001B96E04C050>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000001B9669A4A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001B966911800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001B966895760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321381, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                     │    │           └ <aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>
                     │    └ <function Dispatcher.feed_update at 0x000001B96C2734C0>
                     └ <Dispatcher '0x1b96e02eed0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B96C271C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B96D797170>
                     └ <Dispatcher '0x1b96e02eed0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │       └ Update(update_id=259321381, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001B96E04E090>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │       └ Update(update_id=259321381, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001B96E04E0F0>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │       └ Update(update_id=259321381, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001B96E037740>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │             └ Update(update_id=259321381, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001B96E07F880>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1b96e02eed0'>>, Update(update_id=259321381, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │    │                           │                  └ CallbackQuery(id='1648983057265710761', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x000001B96C272AC0>
                 └ <Dispatcher '0x1b96e02eed0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057265710761', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B96E07F740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B96C271C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B96E04D580>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B96C272B60>
                 └ <Dispatcher '0x1b96e02eed0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                     │      │                           │                  └ CallbackQuery(id='1648983057265710761', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x000001B96C272AC0>
                     └ <Router '0x1b9689a65a0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057265710761', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001B96E06ADE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x000001B96C271C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B9689A6A50>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x000001B96C272B60>
                 └ <Router '0x1b9689a65a0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                     │        │       └ CallbackQuery(id='1648983057265710761', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │        └ <function TelegramEventObserver.trigger at 0x000001B96C271DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001B9689A6A50>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1b96e02eed0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001B96DBDFBF0>,), 'skip_updates'...
                 │             └ CallbackQuery(id='1648983057265710761', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 └ <function CallableObject.call at 0x000001B96E07F560>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function confirm_order at 0x000001B96793B560>, CallbackQuery(id='1648983057265710761', from_user=User(id=6...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 92, in confirm_order
    await state.finish()
          └ <aiogram.fsm.context.FSMContext object at 0x000001B96E25B590>

AttributeError: 'FSMContext' object has no attribute 'finish'
2025-07-21 18:29:02 | INFO | Update id=259321382 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 18:29:12 | INFO | Update id=259321383 is handled. Duration 218 ms by bot id=7986781338
2025-07-21 18:31:54 | INFO | Polling stopped
2025-07-21 18:31:54 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:31:54 | INFO | Bot stopped
2025-07-21 18:31:54 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:32:01 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:32:01 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:32:01 | INFO | Starting bot...
2025-07-21 18:32:01 | INFO | Start polling
2025-07-21 18:32:02 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:32:06 | INFO | Update id=259321384 is handled. Duration 406 ms by bot id=7986781338
2025-07-21 18:32:08 | INFO | Update id=259321385 is handled. Duration 140 ms by bot id=7986781338
2025-07-21 18:32:18 | INFO | Update id=259321386 is handled. Duration 78 ms by bot id=7986781338
2025-07-21 18:32:31 | INFO | Update id=259321387 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:32:38 | INFO | Update id=259321388 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:32:41 | INFO | Update id=259321389 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:32:42 | INFO | Update id=259321390 is not handled. Duration 16 ms by bot id=7986781338
2025-07-21 18:32:42 | ERROR | Cause exception while process update id=259321390 by bot id=7986781338
NameError: name 'callback_query' is not defined
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x00000260498EA020>
    │       └ <function run at 0x000002603FF2C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000026049C93F10>
           │      └ <function Runner.run at 0x0000026042621EE0>
           └ <asyncio.runners.Runner object at 0x0000026049D28110>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002604261BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000026049D28110>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000026042694A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000026042621800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000260425A5760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321390, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                     │    │           └ <aiogram.client.bot.Bot object at 0x00000260499CABD0>
                     │    └ <function Dispatcher.feed_update at 0x0000026047EC34C0>
                     └ <Dispatcher '0x26049d28590'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000026047EC1C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000026049D2A210>
                     └ <Dispatcher '0x26049d28590'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321390, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000026049D2A2D0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321390, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000026049D2A330>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │       └ Update(update_id=259321390, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000026049D5E340>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │             └ Update(update_id=259321390, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000026049D5E5C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x26049d28590'>>, Update(update_id=259321390, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │    │                           │                  └ CallbackQuery(id='1648983057170661926', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000026047EC2AC0>
                 └ <Dispatcher '0x26049d28590'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057170661926', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000026049D5E480>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000026047EC1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000026049D297F0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000026047EC2B60>
                 └ <Dispatcher '0x26049d28590'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                     │      │                           │                  └ CallbackQuery(id='1648983057170661926', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000026047EC2AC0>
                     └ <Router '0x2604467e2d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057170661926', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000026049D5F740>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000026047EC1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002604467E870>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000026047EC2B60>
                 └ <Router '0x2604467e2d0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                     │        │       └ CallbackQuery(id='1648983057170661926', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │        └ <function TelegramEventObserver.trigger at 0x0000026047EC1DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002604467E870>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x26049d28590'>, 'bots': (<aiogram.client.bot.Bot object at 0x00000260499CABD0>,), 'skip_updates'...
                 │             └ CallbackQuery(id='1648983057170661926', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 └ <function CallableObject.call at 0x0000026049D5E3E0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function confirm_order at 0x000002604468B600>, CallbackQuery(id='1648983057170661926', from_user=User(id=6...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 92, in confirm_order
    await callback_query.message.answer("Заказ успешно создан!")

NameError: name 'callback_query' is not defined
2025-07-21 18:32:51 | INFO | Update id=259321391 is handled. Duration 563 ms by bot id=7986781338
2025-07-21 18:34:20 | INFO | Polling stopped
2025-07-21 18:34:20 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:34:20 | INFO | Bot stopped
2025-07-21 18:34:20 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:34:26 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:34:27 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:34:27 | INFO | Starting bot...
2025-07-21 18:34:27 | INFO | Start polling
2025-07-21 18:34:27 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:34:31 | INFO | Update id=259321392 is handled. Duration 265 ms by bot id=7986781338
2025-07-21 18:34:32 | INFO | Update id=259321393 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 18:34:37 | INFO | Update id=259321394 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:34:41 | INFO | Update id=259321395 is handled. Duration 94 ms by bot id=7986781338
2025-07-21 18:34:45 | INFO | Update id=259321396 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 18:34:50 | INFO | Update id=259321397 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:34:53 | INFO | Update id=259321398 is not handled. Duration 281 ms by bot id=7986781338
2025-07-21 18:34:53 | ERROR | Cause exception while process update id=259321398 by bot id=7986781338
DetachedInstanceError: Instance <Order at 0x1505b1276b0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001505AB1A020>
    │       └ <function run at 0x000001505110C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001505AE9FF10>
           │      └ <function Runner.run at 0x0000015053841EE0>
           └ <asyncio.runners.Runner object at 0x000001505ABFE9F0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001505383BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001505ABFE9F0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000150538B4A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000015053841800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000150537C5760>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321398, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                     │    │           └ <aiogram.client.bot.Bot object at 0x000001505ABFD3D0>
                     │    └ <function Dispatcher.feed_update at 0x00000150591934C0>
                     └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015059191C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505AF3E090>
                     └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │       └ Update(update_id=259321398, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001505AF3E1B0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │       └ Update(update_id=259321398, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001505AF3E210>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │       └ Update(update_id=259321398, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001505AF4AE80>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │             └ Update(update_id=259321398, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001505AF6A5C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1505abff650'>>, Update(update_id=259321398, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │    │                           │                  └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000015059192AC0>
                 └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001505AF6A2A0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015059191C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505AF3D670>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015059192B60>
                 └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                     │      │                           │                  └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000015059192AC0>
                     └ <Router '0x1505588e0c0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001505AF2BB00>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015059191C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505588E810>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015059192B60>
                 └ <Router '0x1505588e0c0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                     │        │       └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │        └ <function TelegramEventObserver.trigger at 0x0000015059191DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505588E810>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │             └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 └ <function CallableObject.call at 0x000001505AF6B740>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function confirm_order at 0x000001505589B740>, CallbackQuery(id='1648983057365547800', from_user=User(id=6...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 104, in confirm_order
    await notify_drivers_about_order(order.id, callback.bot)
          │                          │     │   │        └ <property object at 0x0000015053CB63E0>
          │                          │     │   └ CallbackQuery(id='1648983057365547800', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
          │                          │     └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001505AAA2980>
          │                          └ <database.models.Order object at 0x000001505B1276B0>
          └ <function notify_drivers_about_order at 0x000001505AEF1C60>

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           │    │        │      └ {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>}
           │    │        └ <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>
           │    └ <member 'impl' of 'QueryableAttribute' objects>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001505AAA2980>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            │    │                      │      │    └ symbol('PASSIVE_OFF')
            │    │                      │      └ 'id'
            │    │                      └ <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>
            │    └ <function AttributeImpl._fire_loader_callables at 0x000001505A8025C0>
            └ <sqlalchemy.orm.attributes.ScalarAttributeImpl object at 0x000001505B11B880>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
           │     │             │      └ symbol('PASSIVE_OFF')
           │     │             └ <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>
           │     └ <function InstanceState._load_expired at 0x000001505A80BB00>
           └ <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    │    │                                │     │       └ symbol('PASSIVE_OFF')
    │    │                                │     └ {'price', 'client', 'time', 'distance', 'driver', 'bids', 'created_at', 'driver_id', 'client_id', 'start_point', 'end_point',...
    │    │                                └ <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>
    │    └ <member 'manager' of 'InstanceState' objects>
    └ <sqlalchemy.orm.state.InstanceState object at 0x000001505AF74950>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1584, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
          │       └ <class 'sqlalchemy.orm.exc.DetachedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Projects\\Taxi_Tg_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\exc.py'>

sqlalchemy.orm.exc.DetachedInstanceError: Instance <Order at 0x1505b1276b0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-07-21 18:36:25 | INFO | Update id=259321399 is handled. Duration 250 ms by bot id=7986781338
2025-07-21 18:36:27 | INFO | Update id=259321400 is handled. Duration 327 ms by bot id=7986781338
2025-07-21 18:36:28 | INFO | Update id=259321401 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:36:34 | INFO | Update id=259321402 is handled. Duration 155 ms by bot id=7986781338
2025-07-21 18:36:36 | INFO | Update id=259321403 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:36:44 | INFO | Update id=259321404 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:36:47 | INFO | Update id=259321405 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:36:51 | INFO | Update id=259321406 is not handled. Duration 547 ms by bot id=7986781338
2025-07-21 18:36:51 | ERROR | Cause exception while process update id=259321406 by bot id=7986781338
DetachedInstanceError: Instance <Order at 0x1505b40c980> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000001505AB1A020>
    │       └ <function run at 0x000001505110C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000001505AE9FF10>
           │      └ <function Runner.run at 0x0000015053841EE0>
           └ <asyncio.runners.Runner object at 0x000001505ABFE9F0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001505383BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001505ABFE9F0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x00000150538B4A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000015053841800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000150537C5760>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321406, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                     │    │           └ <aiogram.client.bot.Bot object at 0x000001505ABFD3D0>
                     │    └ <function Dispatcher.feed_update at 0x00000150591934C0>
                     └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015059191C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505AF3E090>
                     └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │       └ Update(update_id=259321406, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000001505AF3E1B0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │       └ Update(update_id=259321406, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x000001505AF3E210>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │       └ Update(update_id=259321406, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000001505AF6B7E0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │             └ Update(update_id=259321406, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000001505AF6B920>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x1505abff650'>>, Update(update_id=259321406, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │    │                           │                  └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000015059192AC0>
                 └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000001505AF6A340>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015059191C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505AF3D670>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015059192B60>
                 └ <Dispatcher '0x1505abff650'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                     │      │                           │                  └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000015059192AC0>
                     └ <Router '0x1505588e0c0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000015051866480>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015059191C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505588E810>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015059192B60>
                 └ <Router '0x1505588e0c0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                     │        │       └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │        └ <function TelegramEventObserver.trigger at 0x0000015059191DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000001505588E810>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x1505abff650'>, 'bots': (<aiogram.client.bot.Bot object at 0x000001505ABFD3D0>,), 'skip_updates'...
                 │             └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 └ <function CallableObject.call at 0x000001505AF6B9C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function confirm_order at 0x000001505589B740>, CallbackQuery(id='1648983058682519523', from_user=User(id=6...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 104, in confirm_order
    await notify_drivers_about_order(order.id, callback.bot)
          │                          │     │   │        └ <property object at 0x0000015053CB63E0>
          │                          │     │   └ CallbackQuery(id='1648983058682519523', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
          │                          │     └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001505AAA2980>
          │                          └ <database.models.Order object at 0x000001505B40C980>
          └ <function notify_drivers_about_order at 0x000001505AEF1C60>

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           │    │        │      └ {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>}
           │    │        └ <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>
           │    └ <member 'impl' of 'QueryableAttribute' objects>
           └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x000001505AAA2980>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
            │    │                      │      │    └ symbol('PASSIVE_OFF')
            │    │                      │      └ 'id'
            │    │                      └ <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>
            │    └ <function AttributeImpl._fire_loader_callables at 0x000001505A8025C0>
            └ <sqlalchemy.orm.attributes.ScalarAttributeImpl object at 0x000001505B11B880>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
           │     │             │      └ symbol('PASSIVE_OFF')
           │     │             └ <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>
           │     └ <function InstanceState._load_expired at 0x000001505A80BB00>
           └ <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
    │    │                                │     │       └ symbol('PASSIVE_OFF')
    │    │                                │     └ {'price', 'client', 'time', 'distance', 'driver', 'bids', 'created_at', 'driver_id', 'client_id', 'start_point', 'end_point',...
    │    │                                └ <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>
    │    └ <member 'manager' of 'InstanceState' objects>
    └ <sqlalchemy.orm.state.InstanceState object at 0x000001505B37BAD0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1584, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
          │       └ <class 'sqlalchemy.orm.exc.DetachedInstanceError'>
          └ <module 'sqlalchemy.orm.exc' from 'C:\\Projects\\Taxi_Tg_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\exc.py'>

sqlalchemy.orm.exc.DetachedInstanceError: Instance <Order at 0x1505b40c980> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-07-21 18:37:41 | INFO | Polling stopped
2025-07-21 18:37:41 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:37:41 | INFO | Bot stopped
2025-07-21 18:37:41 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:40:17 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:40:18 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:40:18 | INFO | Starting bot...
2025-07-21 18:40:18 | INFO | Start polling
2025-07-21 18:40:18 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:40:24 | INFO | Update id=259321407 is handled. Duration 313 ms by bot id=7986781338
2025-07-21 18:40:25 | INFO | Update id=259321408 is handled. Duration 140 ms by bot id=7986781338
2025-07-21 18:40:29 | INFO | Update id=259321409 is handled. Duration 186 ms by bot id=7986781338
2025-07-21 18:40:30 | INFO | Update id=259321410 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:40:37 | INFO | Update id=259321411 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:40:40 | INFO | Update id=259321412 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:40:43 | INFO | Update id=259321413 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:40:43 | ERROR | Cause exception while process update id=259321413 by bot id=7986781338
TypeError: 'async_generator' object does not support the asynchronous context manager protocol
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x000002559654A0C0>
    │       └ <function run at 0x000002558CB7C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000025596ADF880>
           │      └ <function Runner.run at 0x000002558F251EE0>
           └ <asyncio.runners.Runner object at 0x0000025596BA4200>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002558F24BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000025596BA4200>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x000002558F2E4A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002558F251800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002558F1D5760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321413, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                     │    │           └ <aiogram.client.bot.Bot object at 0x000002559662C5C0>
                     │    └ <function Dispatcher.feed_update at 0x0000025594B234C0>
                     └ <Dispatcher '0x25596ba41a0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025594B21C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025596BA6030>
                     └ <Dispatcher '0x25596ba41a0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │       └ Update(update_id=259321413, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000025596BA4140>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │       └ Update(update_id=259321413, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000025596BA6150>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │       └ Update(update_id=259321413, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x0000025596B9D3A0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │             └ Update(update_id=259321413, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x0000025596BC05E0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x25596ba41a0'>>, Update(update_id=259321413, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │    │                           │                  └ CallbackQuery(id='1648983057132684517', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x0000025594B22AC0>
                 └ <Dispatcher '0x25596ba41a0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057132684517', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000025596BC3CE0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025594B21C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025596BA55E0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000025594B22B60>
                 └ <Dispatcher '0x25596ba41a0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                     │      │                           │                  └ CallbackQuery(id='1648983057132684517', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x0000025594B22AC0>
                     └ <Router '0x25596922270'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057132684517', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000025596BC3BA0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000025594B21C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025596B6ADE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000025594B22B60>
                 └ <Router '0x25596922270'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                     │        │       └ CallbackQuery(id='1648983057132684517', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │        └ <function TelegramEventObserver.trigger at 0x0000025594B21DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000025596B6ADE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x25596ba41a0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002559662C5C0>,), 'skip_updates'...
                 │             └ CallbackQuery(id='1648983057132684517', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 └ <function CallableObject.call at 0x0000025596D90FE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function confirm_order at 0x0000025596B81080>, CallbackQuery(id='1648983057132684517', from_user=User(id=6...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 95, in confirm_order
    async with get_session() as session:
               └ <function get_session at 0x0000025596549F80>

TypeError: 'async_generator' object does not support the asynchronous context manager protocol
2025-07-21 18:40:59 | INFO | Polling stopped
2025-07-21 18:40:59 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:41:00 | INFO | Bot stopped
2025-07-21 18:41:00 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:41:57 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:41:58 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:41:58 | INFO | Starting bot...
2025-07-21 18:41:58 | INFO | Start polling
2025-07-21 18:41:58 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:42:02 | INFO | Update id=259321414 is handled. Duration 250 ms by bot id=7986781338
2025-07-21 18:42:04 | INFO | Update id=259321415 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 18:42:06 | INFO | Update id=259321416 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:42:07 | INFO | Update id=259321417 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 18:42:12 | INFO | Update id=259321418 is handled. Duration 796 ms by bot id=7986781338
2025-07-21 18:42:14 | INFO | Update id=259321419 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 18:42:17 | INFO | Update id=259321420 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:42:17 | ERROR | Cause exception while process update id=259321420 by bot id=7986781338
IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.id
[SQL: INSERT INTO orders (client_id, driver_id, start_point, end_point, distance, time, price, status, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: (6826384730, None, 'фафыва', 'фывафыва', None, '10:10', 1, 'active', '2025-07-21 15:42:17.463699', '2025-07-21 15:57:17.460700')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000022139C0E480>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x0000022139D32450>
    └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (6826384730, None, 'фафыва', 'фывафыва', None, '10:10', 1, 'active', '2025-07-21 15:42:17.463699', '2025-07-21 15:57:17.460700')
    │      │       └ 'INSERT INTO orders (client_id, driver_id, start_point, end_point, distance, time, price, status, created_at, expires_at) VAL...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x000002213A8087C0>

sqlite3.IntegrityError: NOT NULL constraint failed: orders.id


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000022139FEE160>
    │       └ <function run at 0x000002213065C680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x000002213A57F880>
           │      └ <function Runner.run at 0x0000022132CF1EE0>
           └ <asyncio.runners.Runner object at 0x000002213A644410>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000022132CEBA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002213A644410>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000022132D84A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000022132CF1800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000022132C75760>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321420, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                     │    │           └ <aiogram.client.bot.Bot object at 0x000002213A0CC740>
                     │    └ <function Dispatcher.feed_update at 0x00000221385D34C0>
                     └ <Dispatcher '0x2213a62b0b0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000221385D1C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002213A646090>
                     └ <Dispatcher '0x2213a62b0b0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │       └ Update(update_id=259321420, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x000002213A07DAC0>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │       └ Update(update_id=259321420, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000022139FB3B30>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │       └ Update(update_id=259321420, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function TelegramEventObserver.trigger at 0x000002213A6647C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │             └ Update(update_id=259321420, message=None, edited_message=None, channel_post=None, edited_channel_post=None, message_reaction=...
                 └ <function CallableObject.call at 0x000002213A664680>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x2213a62b0b0'>>, Update(update_id=259321420, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │    │                           │                  └ CallbackQuery(id='1648983057684086108', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │    │                           └ 'callback_query'
                 │    └ <function Router.propagate_event at 0x00000221385D2AC0>
                 └ <Dispatcher '0x2213a62b0b0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057684086108', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002213A831080>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000221385D1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002213A645670>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000221385D2B60>
                 └ <Dispatcher '0x2213a62b0b0'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                     │      │                           │                  └ CallbackQuery(id='1648983057684086108', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │      │                           └ 'callback_query'
                     │      └ <function Router.propagate_event at 0x00000221385D2AC0>
                     └ <Router '0x2213a0e6540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │        │                     │               └ CallbackQuery(id='1648983057684086108', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x000002213A831120>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x00000221385D1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002213A60B020>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x00000221385D2B60>
                 └ <Router '0x2213a0e6540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                     │        │       └ CallbackQuery(id='1648983057684086108', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                     │        └ <function TelegramEventObserver.trigger at 0x00000221385D1DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x000002213A60B020>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x2213a62b0b0'>, 'bots': (<aiogram.client.bot.Bot object at 0x000002213A0CC740>,), 'skip_updates'...
                 │             └ CallbackQuery(id='1648983057684086108', from_user=User(id=6826384730, is_bot=False, first_name='𝕿𝕽𝕴𝕱𝕺𝕹', last_name=None, user...
                 └ <function CallableObject.call at 0x000002213A667D80>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<function confirm_order at 0x000002213A621120>, CallbackQuery(id='1648983057684086108', from_user=User(id=6...

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\client\create_order.py", line 110, in confirm_order
    order_repo.session.commit() # Коммитим изменения
    │          │       └ <function Session.commit at 0x0000022139E8A660>
    │          └ <sqlalchemy.orm.session.Session object at 0x000002213A85BFB0>
    └ <database.repositories.OrderRepository object at 0x000002213A680530>

  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1969, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000022139E89760>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002213A63BD10>
  File "<string>", line 2, in commit
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002213A63BD10>
                └ <function SessionTransaction.commit at 0x0000022139E89580>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1256, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000022139E89440>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002213A63BD10>
  File "<string>", line 2, in _prepare_impl
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002213A63BD10>
                └ <function SessionTransaction._prepare_impl at 0x0000022139E893A0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1231, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000022139E95580>
    │    └ <sqlalchemy.orm.session.Session object at 0x000002213A85BFB0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002213A63BD10>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4312, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000022139E95760>
    └ <sqlalchemy.orm.session.Session object at 0x000002213A85BFB0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4447, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Projects\\Taxi_Tg_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000002213A99E5C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlite3.IntegrityError) NOT NULL constraint failed: orders.id')
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4408, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x0000022139E65F80>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000002213A990E00>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000002213A990E00>
    │   └ <function SaveUpdateAll.execute at 0x0000022139E66AC0>
    └ SaveUpdateAll(Mapper[Order(orders)])
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000022139DDA0C0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Projects\\Taxi_Tg_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Projects\\Taxi_Tg_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\preloaded.py'>
    └ <module 'sqlalchemy.util' from 'C:\\Projects\\Taxi_Tg_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\__init__.py'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x0000022139E58FE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1227, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x0000022139B5F560>
             └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000002213A9904D0>>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 517, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000022139B5F880>
           └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000022139B5FA60>
          └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1848, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000022139B5FB00>
           └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000022139B5FD80>
    └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError('NOT NULL constraint failed: orders.id')
          │                    │              └ (<class 'sqlite3.IntegrityError'>, IntegrityError('NOT NULL constraint failed: orders.id'), <traceback object at 0x000002213A...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(sqlite3.IntegrityError) NOT NULL constraint failed: orders.id')
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000022139C0E480>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x0000022139D32450>
    └ <sqlalchemy.engine.base.Connection object at 0x000002213A85A4B0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ (6826384730, None, 'фафыва', 'фывафыва', None, '10:10', 1, 'active', '2025-07-21 15:42:17.463699', '2025-07-21 15:57:17.460700')
    │      │       └ 'INSERT INTO orders (client_id, driver_id, start_point, end_point, distance, time, price, status, created_at, expires_at) VAL...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x000002213A8087C0>

sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) NOT NULL constraint failed: orders.id
[SQL: INSERT INTO orders (client_id, driver_id, start_point, end_point, distance, time, price, status, created_at, expires_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: (6826384730, None, 'фафыва', 'фывафыва', None, '10:10', 1, 'active', '2025-07-21 15:42:17.463699', '2025-07-21 15:57:17.460700')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-21 18:43:27 | INFO | Polling stopped
2025-07-21 18:43:27 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:43:27 | ERROR | Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [Errno 1] [SSL: APPLICATION_DATA_AFTER_CLOSE_NOTIFY] application data after close notify (_ssl.c:2685)
2025-07-21 18:43:27 | WARNING | Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 7986781338)
2025-07-21 18:43:28 | INFO | Bot stopped
2025-07-21 18:43:28 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:43:36 | DEBUG | Using proactor: IocpProactor
2025-07-21 18:43:37 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 18:43:37 | INFO | Starting bot...
2025-07-21 18:43:37 | INFO | Start polling
2025-07-21 18:43:37 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 18:43:41 | INFO | Update id=259321421 is handled. Duration 233 ms by bot id=7986781338
2025-07-21 18:43:43 | INFO | Update id=259321422 is handled. Duration 452 ms by bot id=7986781338
2025-07-21 18:43:45 | INFO | Update id=259321423 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:43:46 | INFO | Update id=259321424 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:43:52 | INFO | Update id=259321425 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:43:54 | INFO | Update id=259321426 is handled. Duration 422 ms by bot id=7986781338
2025-07-21 18:43:56 | INFO | Update id=259321427 is handled. Duration 327 ms by bot id=7986781338
2025-07-21 18:44:03 | INFO | Update id=259321428 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 18:44:16 | INFO | Update id=259321429 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:44:55 | INFO | Update id=259321430 is handled. Duration 250 ms by bot id=7986781338
2025-07-21 18:45:06 | INFO | Update id=259321431 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 18:45:13 | INFO | Update id=259321432 is handled. Duration 265 ms by bot id=7986781338
2025-07-21 18:45:19 | INFO | Update id=259321433 is handled. Duration 157 ms by bot id=7986781338
2025-07-21 18:45:20 | INFO | Update id=259321434 is handled. Duration 250 ms by bot id=7986781338
2025-07-21 18:45:30 | INFO | Update id=259321435 is handled. Duration 188 ms by bot id=7986781338
2025-07-21 18:45:33 | INFO | Update id=259321436 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 18:45:37 | INFO | Update id=259321437 is handled. Duration 500 ms by bot id=7986781338
2025-07-21 18:45:41 | INFO | Update id=259321438 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 18:56:04 | INFO | Update id=259321439 is handled. Duration 280 ms by bot id=7986781338
2025-07-21 18:56:15 | INFO | Update id=259321440 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 18:56:54 | INFO | Update id=259321441 is handled. Duration 218 ms by bot id=7986781338
2025-07-21 18:56:59 | INFO | Update id=259321442 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 18:57:01 | INFO | Update id=259321443 is handled. Duration 297 ms by bot id=7986781338
2025-07-21 18:57:09 | INFO | Update id=259321444 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 18:57:11 | INFO | Update id=259321445 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 18:57:18 | INFO | Update id=259321446 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:57:18 | ERROR | Cause exception while process update id=259321446 by bot id=7986781338
AttributeError: 'NoneType' object has no attribute 'lower'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000015DE108E0C0>
    │       └ <function run at 0x0000015DD76BC680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000015DE161F880>
           │      └ <function Runner.run at 0x0000015DD9D91EE0>
           └ <asyncio.runners.Runner object at 0x0000015DE16E44D0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000015DD9D8BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000015DE16E44D0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000015DD9E24A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000015DD9D91800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000015DD9D15760>
    └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321446, message=Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC...
                     │    │           └ <aiogram.client.bot.Bot object at 0x0000015DE105F260>
                     │    └ <function Dispatcher.feed_update at 0x0000015DDF6F34C0>
                     └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015DDF6F1C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16E6150>
                     └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │       └ Update(update_id=259321446, message=Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000015DE16E6270>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │       └ Update(update_id=259321446, message=Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000015DE16E62D0>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │       └ Update(update_id=259321446, message=Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC...
                 └ <function TelegramEventObserver.trigger at 0x0000015DE1703CE0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │             └ Update(update_id=259321446, message=Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC...
                 └ <function CallableObject.call at 0x0000015DE1703EC0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x15ddbe1e540'>>, Update(update_id=259321446, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x0000015DDF6F2AC0>
                 └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000015DE17014E0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015DDF6F1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE15B1BB0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015DDF6F2B60>
                 └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x0000015DDF6F2AC0>
                     └ <Router '0x15de16ca030'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000015DE1703E20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015DDF6F1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16CA0C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015DDF6F2B60>
                 └ <Router '0x15de16ca030'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                     │        │       └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                     │        └ <function TelegramEventObserver.trigger at 0x0000015DDF6F1DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16CA0C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 113, in trigger
    result, data = await handler.check(event, **kwargs)
                         │       │     │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                         │       │     └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                         │       └ <function HandlerObject.check at 0x0000015DDF6F1440>
                         └ HandlerObject(callback=<function handle_feedback at 0x0000015DE16C3E20>, awaitable=True, params={'message'}, varkw=False, fil...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 94, in check
    check = await event_filter.call(*args, **kwargs)
                  │            │     │       └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                  │            │     └ (Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='...
                  │            └ <function CallableObject.call at 0x0000015DDF6F0B80>
                  └ FilterObject(callback=<function <lambda> at 0x0000015DE16C3CE0>, awaitable=False, params={'message'}, varkw=False, magic=None)
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 48, in call
    return await loop.run_in_executor(None, wrapped)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x0000015DE170DD40>, functools.partial(<function <la...
                 │    └ <function BaseEventLoop.run_in_executor at 0x0000015DD9D90360>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\common\feedback.py", line 5, in <lambda>
    @router.message(lambda message: "отзыв" in message.text.lower())
     │      │              │                   │       └ None
     │      │              │                   └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
     │      │              └ Message(message_id=254, date=datetime.datetime(2025, 7, 21, 15, 57, 18, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
     │      └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16CA0C0>
     └ <Router '0x15de16ca030'>

AttributeError: 'NoneType' object has no attribute 'lower'
2025-07-21 18:58:34 | INFO | Update id=259321447 is handled. Duration 172 ms by bot id=7986781338
2025-07-21 18:58:39 | INFO | Update id=259321448 is not handled. Duration 0 ms by bot id=7986781338
2025-07-21 18:58:39 | ERROR | Cause exception while process update id=259321448 by bot id=7986781338
AttributeError: 'NoneType' object has no attribute 'lower'
Traceback (most recent call last):

  File "C:\Projects\Taxi_Tg_Bot\main.py", line 68, in <module>
    asyncio.run(main())
    │       │   └ <function main at 0x0000015DE108E0C0>
    │       └ <function run at 0x0000015DD76BC680>
    └ <module 'asyncio' from 'C:\\Users\\The Great Programmer\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\__init__....

  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object main at 0x0000015DE161F880>
           │      └ <function Runner.run at 0x0000015DD9D91EE0>
           └ <asyncio.runners.Runner object at 0x0000015DE16E44D0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<main() running at C:\Projects\Taxi_Tg_Bot\main.py:56> wait_for=<Future pending cb=[Task.tas...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000015DD9D8BA60>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000015DE16E44D0>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 674, in run_until_complete
    self.run_forever()
    │    └ <function ProactorEventLoop.run_forever at 0x0000015DD9E24A40>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 322, in run_forever
    super().run_forever()
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 641, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000015DD9D91800>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1987, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000015DD9D15760>
    └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\asyncio\events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finis...ute 'lower'")>)>
> File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
                     │    │           │    │         └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                     │    │           │    └ Update(update_id=259321448, message=Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC...
                     │    │           └ <aiogram.client.bot.Bot object at 0x0000015DE105F260>
                     │    └ <function Dispatcher.feed_update at 0x0000015DDF6F34C0>
                     └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
                     │    │      └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015DDF6F1C60>
                     │    └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16E6150>
                     └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │       └ Update(update_id=259321448, message=Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC...
                 └ functools.partial(<aiogram.dispatcher.middlewares.user_context.UserContextMiddleware object at 0x0000015DE16E6270>, functools...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 27, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │       └ Update(update_id=259321448, message=Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC...
                 └ functools.partial(<aiogram.fsm.middleware.FSMContextMiddleware object at 0x0000015DE16E62D0>, <function TelegramEventObserver...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 41, in __call__
    return await handler(event, data)
                 │       │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │       └ Update(update_id=259321448, message=Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC...
                 └ <function TelegramEventObserver.trigger at 0x0000015DE18D1120>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
                 │             │      └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │             └ Update(update_id=259321448, message=Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC...
                 └ <function CallableObject.call at 0x0000015DE17007C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
                 └ functools.partial(<bound method Dispatcher._listen_update of <Dispatcher '0x15ddbe1e540'>>, Update(update_id=259321448, messa...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
                 │    │                           │                  │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │    │                           │                  └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │    │                           └ 'message'
                 │    └ <function Router.propagate_event at 0x0000015DDF6F2AC0>
                 └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000015DE1703EC0>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015DDF6F1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE15B1BB0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015DDF6F2B60>
                 └ <Dispatcher '0x15ddbe1e540'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 156, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
                     │      │                           │                  │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                     │      │                           │                  └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                     │      │                           └ 'message'
                     │      └ <function Router.propagate_event at 0x0000015DDF6F2AC0>
                     └ <Router '0x15de16ca030'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 128, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
                 │        │                     │               │           └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                 │        │                     │               └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                 │        │                     └ <function Router.propagate_event.<locals>._wrapped at 0x0000015DE1703E20>
                 │        └ <function TelegramEventObserver.wrap_outer_middleware at 0x0000015DDF6F1C60>
                 └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16CA0C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 123, in _wrapped
    return await self._propagate_event(
                 │    └ <function Router._propagate_event at 0x0000015DDF6F2B60>
                 └ <Router '0x15de16ca030'>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 148, in _propagate_event
    response = await observer.trigger(event, **kwargs)
                     │        │       │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                     │        │       └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                     │        └ <function TelegramEventObserver.trigger at 0x0000015DDF6F1DA0>
                     └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16CA0C0>
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 113, in trigger
    result, data = await handler.check(event, **kwargs)
                         │       │     │        └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                         │       │     └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
                         │       └ <function HandlerObject.check at 0x0000015DDF6F1440>
                         └ HandlerObject(callback=<function handle_feedback at 0x0000015DE16C3E20>, awaitable=True, params={'message'}, varkw=False, fil...
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 94, in check
    check = await event_filter.call(*args, **kwargs)
                  │            │     │       └ {'dispatcher': <Dispatcher '0x15ddbe1e540'>, 'bots': (<aiogram.client.bot.Bot object at 0x0000015DE105F260>,), 'skip_updates'...
                  │            │     └ (Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='...
                  │            └ <function CallableObject.call at 0x0000015DDF6F0B80>
                  └ FilterObject(callback=<function <lambda> at 0x0000015DE16C3CE0>, awaitable=False, params={'message'}, varkw=False, magic=None)
  File "C:\Projects\Taxi_Tg_Bot\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 48, in call
    return await loop.run_in_executor(None, wrapped)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x0000015DE1635080>, functools.partial(<function <la...
                 │    └ <function BaseEventLoop.run_in_executor at 0x0000015DD9D90360>
                 └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\The Great Programmer\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "C:\Projects\Taxi_Tg_Bot\bot\handlers\common\feedback.py", line 5, in <lambda>
    @router.message(lambda message: "отзыв" in message.text.lower())
     │      │              │                   │       └ None
     │      │              │                   └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
     │      │              └ Message(message_id=257, date=datetime.datetime(2025, 7, 21, 15, 58, 39, tzinfo=TzInfo(UTC)), chat=Chat(id=6826384730, type='p...
     │      └ <aiogram.dispatcher.event.telegram.TelegramEventObserver object at 0x0000015DE16CA0C0>
     └ <Router '0x15de16ca030'>

AttributeError: 'NoneType' object has no attribute 'lower'
2025-07-21 18:59:56 | INFO | Polling stopped
2025-07-21 18:59:56 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 18:59:56 | INFO | Bot stopped
2025-07-21 18:59:56 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 19:01:30 | DEBUG | Using proactor: IocpProactor
2025-07-21 19:01:30 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 19:01:30 | INFO | Starting bot...
2025-07-21 19:01:30 | INFO | Start polling
2025-07-21 19:01:31 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 19:01:39 | INFO | Update id=259321449 is handled. Duration 265 ms by bot id=7986781338
2025-07-21 19:01:41 | INFO | Update id=259321450 is handled. Duration 156 ms by bot id=7986781338
2025-07-21 19:01:44 | INFO | Update id=259321451 is handled. Duration 171 ms by bot id=7986781338
2025-07-21 19:01:46 | INFO | Update id=259321452 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 19:01:55 | INFO | Update id=259321453 is handled. Duration 186 ms by bot id=7986781338
2025-07-21 19:02:09 | INFO | Update id=259321454 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 19:06:52 | INFO | Polling stopped
2025-07-21 19:06:52 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 19:06:53 | INFO | Bot stopped
2025-07-21 19:06:53 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 19:07:00 | DEBUG | Using proactor: IocpProactor
2025-07-21 19:07:01 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 19:07:01 | INFO | Starting bot...
2025-07-21 19:07:01 | INFO | Start polling
2025-07-21 19:07:01 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 19:07:08 | INFO | Update id=259321455 is handled. Duration 233 ms by bot id=7986781338
2025-07-21 19:07:10 | INFO | Update id=259321456 is handled. Duration 141 ms by bot id=7986781338
2025-07-21 19:07:13 | INFO | Update id=259321457 is handled. Duration 202 ms by bot id=7986781338
2025-07-21 19:07:14 | INFO | Update id=259321458 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 19:07:24 | INFO | Update id=259321459 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 19:07:27 | INFO | Update id=259321460 is handled. Duration 280 ms by bot id=7986781338
2025-07-21 19:08:14 | INFO | Update id=259321461 is handled. Duration 187 ms by bot id=7986781338
2025-07-21 19:08:16 | INFO | Update id=259321462 is handled. Duration 186 ms by bot id=7986781338
2025-07-21 19:08:21 | INFO | Update id=259321463 is handled. Duration 94 ms by bot id=7986781338
2025-07-21 19:08:29 | INFO | Update id=259321464 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 19:08:43 | INFO | Update id=259321465 is handled. Duration 94 ms by bot id=7986781338
2025-07-21 19:09:02 | INFO | Update id=259321466 is handled. Duration 343 ms by bot id=7986781338
2025-07-21 19:41:51 | INFO | Polling stopped
2025-07-21 19:41:51 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 19:41:51 | INFO | Bot stopped
2025-07-21 19:41:51 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 20:37:33 | DEBUG | Using proactor: IocpProactor
2025-07-21 20:37:34 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 20:37:34 | INFO | Starting bot...
2025-07-21 20:37:34 | INFO | Start polling
2025-07-21 20:37:34 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 20:37:41 | INFO | Update id=259321467 is handled. Duration 467 ms by bot id=7986781338
2025-07-21 20:37:44 | INFO | Update id=259321468 is handled. Duration 93 ms by bot id=7986781338
2025-07-21 20:37:45 | INFO | Update id=259321469 is handled. Duration 77 ms by bot id=7986781338
2025-07-21 20:37:58 | INFO | Update id=259321470 is handled. Duration 108 ms by bot id=7986781338
2025-07-21 20:38:00 | INFO | Update id=259321471 is handled. Duration 452 ms by bot id=7986781338
2025-07-21 20:43:18 | INFO | Polling stopped
2025-07-21 20:43:18 | DEBUG | FSM Storage database database.db has been closed.
2025-07-21 20:43:19 | INFO | Bot stopped
2025-07-21 20:43:19 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 20:43:27 | INFO | Admin IDs: [123456789, 987654321, 6826384730]
2025-07-21 20:43:27 | DEBUG | Using proactor: IocpProactor
2025-07-21 20:43:28 | DEBUG | FSM Storage database database.db has been opened.
2025-07-21 20:43:28 | INFO | Starting bot...
2025-07-21 20:43:28 | INFO | Start polling
2025-07-21 20:43:28 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-21 20:48:11 | INFO | Update id=259321472 is handled. Duration 327 ms by bot id=7986781338
2025-07-21 20:48:14 | INFO | Update id=259321473 is handled. Duration 109 ms by bot id=7986781338
2025-07-21 20:48:16 | INFO | Update id=259321474 is handled. Duration 139 ms by bot id=7986781338
2025-07-21 20:48:20 | INFO | Update id=259321475 is handled. Duration 172 ms by bot id=7986781338
2025-07-21 20:48:21 | INFO | Update id=259321476 is handled. Duration 125 ms by bot id=7986781338
2025-07-21 20:48:42 | INFO | Update id=259321477 is handled. Duration 188 ms by bot id=7986781338
2025-07-21 20:49:14 | INFO | Update id=259321478 is handled. Duration 391 ms by bot id=7986781338
2025-07-22 01:26:43 | INFO | Polling stopped
2025-07-22 01:26:43 | DEBUG | FSM Storage database database.db has been closed.
2025-07-22 01:26:44 | INFO | Bot stopped
2025-07-22 01:26:44 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 12:52:33 | DEBUG | Using proactor: IocpProactor
2025-07-23 12:52:34 | DEBUG | FSM Storage database database.db has been opened.
2025-07-23 12:52:34 | INFO | Starting bot...
2025-07-23 12:52:34 | INFO | Start polling
2025-07-23 12:52:34 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 12:52:49 | INFO | Update id=259321479 is handled. Duration 593 ms by bot id=7986781338
2025-07-23 12:52:52 | INFO | Update id=259321480 is handled. Duration 141 ms by bot id=7986781338
2025-07-23 12:52:54 | INFO | Update id=259321481 is handled. Duration 295 ms by bot id=7986781338
2025-07-23 12:53:05 | INFO | Update id=259321482 is handled. Duration 108 ms by bot id=7986781338
2025-07-23 12:53:07 | INFO | Update id=259321483 is handled. Duration 483 ms by bot id=7986781338
2025-07-23 12:57:57 | INFO | Polling stopped
2025-07-23 12:57:57 | DEBUG | FSM Storage database database.db has been closed.
2025-07-23 12:57:57 | INFO | Bot stopped
2025-07-23 12:57:57 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 13:14:23 | DEBUG | Using proactor: IocpProactor
2025-07-23 13:14:24 | DEBUG | FSM Storage database database.db has been opened.
2025-07-23 13:14:24 | INFO | Starting bot...
2025-07-23 13:14:24 | INFO | Start polling
2025-07-23 13:14:25 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 13:14:26 | INFO | Update id=259321485 is handled. Duration 608 ms by bot id=7986781338
2025-07-23 13:14:30 | INFO | Update id=259321486 is handled. Duration 125 ms by bot id=7986781338
2025-07-23 13:14:40 | INFO | Update id=259321487 is handled. Duration 157 ms by bot id=7986781338
2025-07-23 13:14:41 | INFO | Update id=259321488 is handled. Duration 172 ms by bot id=7986781338
2025-07-23 13:14:43 | INFO | Update id=259321489 is handled. Duration 93 ms by bot id=7986781338
2025-07-23 13:14:44 | INFO | Update id=259321490 is handled. Duration 108 ms by bot id=7986781338
2025-07-23 13:14:54 | INFO | Update id=259321491 is handled. Duration 125 ms by bot id=7986781338
2025-07-23 13:14:56 | INFO | Update id=259321492 is handled. Duration 452 ms by bot id=7986781338
2025-07-23 13:16:12 | INFO | Polling stopped
2025-07-23 13:16:12 | DEBUG | FSM Storage database database.db has been closed.
2025-07-23 13:16:12 | INFO | Bot stopped
2025-07-23 13:16:12 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 13:16:12 | INFO | Update id=259321493 is not handled. Duration 3016 ms by bot id=7986781338
2025-07-23 13:16:24 | DEBUG | Using proactor: IocpProactor
2025-07-23 13:16:25 | DEBUG | FSM Storage database database.db has been opened.
2025-07-23 13:16:25 | INFO | Starting bot...
2025-07-23 13:16:25 | INFO | Start polling
2025-07-23 13:16:26 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 13:16:29 | INFO | Update id=259321494 is handled. Duration 593 ms by bot id=7986781338
2025-07-23 13:16:31 | INFO | Update id=259321495 is handled. Duration 157 ms by bot id=7986781338
2025-07-23 13:16:32 | INFO | Update id=259321496 is handled. Duration 125 ms by bot id=7986781338
2025-07-23 13:16:39 | INFO | Update id=259321497 is handled. Duration 125 ms by bot id=7986781338
2025-07-23 13:16:41 | INFO | Update id=259321498 is handled. Duration 421 ms by bot id=7986781338
2025-07-23 13:17:28 | INFO | Polling stopped
2025-07-23 13:17:28 | DEBUG | FSM Storage database database.db has been closed.
2025-07-23 13:17:28 | INFO | Bot stopped
2025-07-23 13:17:28 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 13:17:36 | DEBUG | Using proactor: IocpProactor
2025-07-23 13:17:36 | DEBUG | FSM Storage database database.db has been opened.
2025-07-23 13:17:36 | INFO | Starting bot...
2025-07-23 13:17:36 | INFO | Start polling
2025-07-23 13:17:37 | INFO | Run polling for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
2025-07-23 13:17:40 | INFO | Polling stopped
2025-07-23 13:17:40 | DEBUG | FSM Storage database database.db has been closed.
2025-07-23 13:17:40 | INFO | Bot stopped
2025-07-23 13:17:40 | INFO | Polling stopped for bot @Taxi_TGG_bot id=7986781338 - 'Taxi 🚕 Bot'
